{
  "pull-logs": {
    "name": "Pull CloudWatch Logs",
    "description": "Stream and filter CloudWatch log groups for a service or time range.",
    "risk": "low",
    "target": "CloudWatch Log Groups",
    "runbook": "api-gateway-5xx",
    "categories": ["Infrastructure"],
    "permissions": {
      "L1-operator": { "run": true },
      "L2-engineer": { "run": true },
      "L3-admin": "*"
    }
  },
  "purge-cache": {
    "name": "Purge Cache",
    "description": "Flush ElastiCache Redis cluster and invalidate CloudFront distributions.",
    "risk": "medium",
    "target": "ElastiCache Redis + CloudFront CDN",
    "runbook": "session-cache",
    "categories": ["Backend", "Infrastructure"],
    "permissions": {
      "L1-operator": { "run": true },
      "L2-engineer": { "run": true, "approve": true },
      "L3-admin": "*"
    }
  },
  "restart-pods": {
    "name": "Restart EKS Pods",
    "description": "Rolling restart of a Kubernetes deployment via SSM RunCommand.",
    "risk": "medium",
    "target": "EKS Deployments",
    "runbook": "eks-instability",
    "categories": ["Infrastructure"],
    "permissions": {
      "L1-operator": { "run": true },
      "L2-engineer": { "run": true, "approve": true },
      "L3-admin": "*"
    }
  },
  "scale-service": {
    "name": "Scale Service",
    "description": "Adjust ECS desired count or EKS HPA min/max replicas.",
    "risk": "medium",
    "target": "ECS / EKS Autoscaling",
    "runbook": "enrolment-spikes",
    "categories": ["Backend", "Infrastructure"],
    "permissions": {
      "L1-operator": { "run": true },
      "L2-engineer": { "run": true, "approve": true },
      "L3-admin": "*"
    }
  },
  "drain-traffic": {
    "name": "Drain Traffic",
    "description": "Deregister targets from ALB target group to drain traffic from a faulty AZ.",
    "risk": "medium",
    "target": "ALB Target Groups",
    "runbook": "api-gateway-5xx",
    "categories": ["Infrastructure"],
    "permissions": {
      "L1-operator": { "run": true },
      "L2-engineer": { "run": true, "approve": true },
      "L3-admin": "*"
    }
  },
  "maintenance-mode": {
    "name": "Enable Maintenance Mode",
    "description": "Toggle AppConfig feature flag to pause public enrolment flows while keeping admin access.",
    "risk": "high",
    "target": "Edge + Enrolment APIs",
    "runbook": "enrolment-spikes",
    "categories": ["Frontend", "Backend", "Infrastructure"],
    "permissions": {
      "L1-operator": { "request": true },
      "L2-engineer": { "run": true, "approve": true },
      "L3-admin": "*"
    }
  },
  "blacklist-ip": {
    "name": "Blacklist IP",
    "description": "Add IP ranges to WAF IP set to block abusive traffic at the edge.",
    "risk": "high",
    "target": "WAF IP Sets",
    "runbook": "fraud-risk-checks",
    "categories": ["Security", "Infrastructure"],
    "permissions": {
      "L1-operator": { "request": true },
      "L2-engineer": { "run": true, "approve": true },
      "L3-admin": "*"
    }
  },
  "failover-region": {
    "name": "Failover Region",
    "description": "Override Route 53 health checks and trigger RDS failover to shift traffic from a degraded region.",
    "risk": "high",
    "target": "Route 53 + RDS",
    "runbook": "rds-connection-storms",
    "categories": ["Infrastructure", "Backend"],
    "permissions": {
      "L1-operator": { "request": true },
      "L2-engineer": { "run": true, "approve": true },
      "L3-admin": "*"
    }
  },
  "pause-enrolments": {
    "name": "Pause Enrolments",
    "description": "Temporarily block new account creation while allowing existing user login.",
    "risk": "high",
    "target": "Enrolment API",
    "runbook": "enrolment-spikes",
    "categories": ["Backend", "Security"],
    "permissions": {
      "L1-operator": { "request": true },
      "L2-engineer": { "run": true, "approve": true },
      "L3-admin": "*"
    }
  },
  "rotate-secrets": {
    "name": "Rotate Secrets",
    "description": "Trigger staged credential rotation via Secrets Manager for service-to-service auth.",
    "risk": "high",
    "target": "Secrets Manager",
    "runbook": "login-failures",
    "categories": ["Security", "Backend"],
    "permissions": {
      "L1-operator": { "request": true },
      "L2-engineer": { "request": true },
      "L3-admin": "*"
    }
  },
  "revoke-sessions": {
    "name": "Revoke User Sessions",
    "description": "Force-revoke all active Cognito sessions and tokens for a compromised or suspicious user account.",
    "risk": "high",
    "target": "Cognito User Pool Sessions",
    "runbook": "session-revocation",
    "categories": ["Security"],
    "permissions": {
      "L1-operator": { "request": true },
      "L2-engineer": { "run": true, "approve": true },
      "L3-admin": "*"
    }
  },
  "flush-token-cache": {
    "name": "Flush OIDC Token Cache",
    "description": "Clear cached JWKS keys and OIDC discovery metadata to pick up rotated signing keys immediately.",
    "risk": "medium",
    "target": "OIDC / JWKS Cache",
    "runbook": "token-cache-refresh",
    "categories": ["Backend", "Security"],
    "permissions": {
      "L1-operator": { "run": true },
      "L2-engineer": { "run": true, "approve": true },
      "L3-admin": "*"
    }
  },
  "toggle-idv-provider": {
    "name": "Toggle IDV Provider",
    "description": "Switch the active identity document verification provider for failover or incident response.",
    "risk": "high",
    "target": "Document Verification Service",
    "runbook": "idv-provider-failover",
    "categories": ["Backend", "Security"],
    "permissions": {
      "L1-operator": { "request": true },
      "L2-engineer": { "run": true, "approve": true },
      "L3-admin": "*"
    }
  },
  "export-audit-log": {
    "name": "Export Audit Log",
    "description": "Export DynamoDB audit trail records to S3 for compliance reporting or incident investigation.",
    "risk": "low",
    "target": "DynamoDB Audit Table + S3",
    "runbook": "audit-export-procedure",
    "categories": ["Security", "Infrastructure"],
    "permissions": {
      "L1-operator": { "run": true },
      "L2-engineer": { "run": true },
      "L3-admin": "*"
    }
  },
  "disable-user": {
    "name": "Disable User Account",
    "description": "Disable a Cognito user account to block sign-in pending investigation. Does not delete user data.",
    "risk": "high",
    "target": "Cognito User Pool",
    "runbook": "account-suspension",
    "categories": ["Security"],
    "permissions": {
      "L1-operator": { "request": true },
      "L2-engineer": { "run": true, "approve": true },
      "L3-admin": "*"
    }
  }
}
